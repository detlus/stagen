#!/usr/bin/env node

var _ = require('underscore'),
  path = require('path');

var argv = require('minimist')(process.argv.slice(2), {boolean: true});

var pwd = process.cwd();
if (argv._.length) {
  // Change path if path is provided.
  argv._[0] = path.resolve(pwd, argv._[0]);
  pwd = argv._[0];
}

var stagen = require('../lib/stagen');
var ContentManager = require('../lib/content-manager');


var site = new stagen.Site(pwd);
if (site.init()) {
  site.clean();
  var cm = new ContentManager(site);
  cm.registerType(require('../lib/content-types/post'));
  cm.registerType(require('../lib/content-types/listing-page'));
  cm.registerType(require('../lib/content-types/page'));
  cm.registerType(require('../lib/content-types/feed'));
  cm.generateOutput();
  cm.copyThemeAssets();
}
site.finalize();
